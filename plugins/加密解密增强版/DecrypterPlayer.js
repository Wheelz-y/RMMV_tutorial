var MD5=function(a){function b(a,b){var d,c,e,l;e=a&2147483648;l=b&2147483648;d=a&1073741824;c=b&1073741824;a=(a&1073741823)+(b&1073741823);return d&c?a^2147483648^e^l:d|c?a&1073741824?a^3221225472^e^l:a^1073741824^e^l:a^e^l}function c(a,d,c,e,l,f,g){a=b(a,b(b(d&c|~d&e,l),g));return b(a<<f|a>>>32-f,d)}function d(a,d,c,e,l,f,g){a=b(a,b(b(d&e|c&~e,l),g));return b(a<<f|a>>>32-f,d)}function l(a,d,c,e,l,f,g){a=b(a,b(b(d^c^e,l),g));return b(a<<f|a>>>32-f,d)}function m(a,d,c,e,l,f,g){a=b(a,b(b(c^(d|~e),l),g));return b(a<<f|a>>>32-f,d)}function n(a){var b="",d,c;for(c=0;3>=c;c++)d=a>>>8*c&255,d="0"+d.toString(16),b+=d.substr(d.length-2,2);return b}var e=[],p,q,r,t,f,g,h,k;a=function(a){a=a.replace(/\r\n/g,"\n");for(var b="",d=0;d<a.length;d++){var c=a.charCodeAt(d);128>c?b+=String.fromCharCode(c):(127<c&&2048>c?b+=String.fromCharCode(c>>6|192):(b+=String.fromCharCode(c>>12|224),b+=String.fromCharCode(c>>6&63|128)),b+=String.fromCharCode(c&63|128))}return b}(a);e=function(a){var b,d=a.length;b=d+8;for(var c=16*((b-b%64)/64+1),e=Array(c-1),l,f=0;f<d;)b=(f-f%4)/4,l=f%4*8,e[b]|=a.charCodeAt(f)<<l,f++;e[(f-f%4)/4]|=128<<f%4*8;e[c-2]=d<<3;e[c-1]=d>>>29;return e}(a);f=1732584193;g=4023233417;h=2562383102;k=271733878;for(a=0;a<e.length;a+=16)p=f,q=g,r=h,t=k,f=c(f,g,h,k,e[a+0],7,3614090360),k=c(k,f,g,h,e[a+1],12,3905402710),h=c(h,k,f,g,e[a+2],17,606105819),g=c(g,h,k,f,e[a+3],22,3250441966),f=c(f,g,h,k,e[a+4],7,4118548399),k=c(k,f,g,h,e[a+5],12,1200080426),h=c(h,k,f,g,e[a+6],17,2821735955),g=c(g,h,k,f,e[a+7],22,4249261313),f=c(f,g,h,k,e[a+8],7,1770035416),k=c(k,f,g,h,e[a+9],12,2336552879),h=c(h,k,f,g,e[a+10],17,4294925233),g=c(g,h,k,f,e[a+11],22,2304563134),f=c(f,g,h,k,e[a+12],7,1804603682),k=c(k,f,g,h,e[a+13],12,4254626195),h=c(h,k,f,g,e[a+14],17,2792965006),g=c(g,h,k,f,e[a+15],22,1236535329),f=d(f,g,h,k,e[a+1],5,4129170786),k=d(k,f,g,h,e[a+6],9,3225465664),h=d(h,k,f,g,e[a+11],14,643717713),g=d(g,h,k,f,e[a+0],20,3921069994),f=d(f,g,h,k,e[a+5],5,3593408605),k=d(k,f,g,h,e[a+10],9,38016083),h=d(h,k,f,g,e[a+15],14,3634488961),g=d(g,h,k,f,e[a+4],20,3889429448),f=d(f,g,h,k,e[a+9],5,568446438),k=d(k,f,g,h,e[a+14],9,3275163606),h=d(h,k,f,g,e[a+3],14,4107603335),g=d(g,h,k,f,e[a+8],20,1163531501),f=d(f,g,h,k,e[a+13],5,2850285829),k=d(k,f,g,h,e[a+2],9,4243563512),h=d(h,k,f,g,e[a+7],14,1735328473),g=d(g,h,k,f,e[a+12],20,2368359562),f=l(f,g,h,k,e[a+5],4,4294588738),k=l(k,f,g,h,e[a+8],11,2272392833),h=l(h,k,f,g,e[a+11],16,1839030562),g=l(g,h,k,f,e[a+14],23,4259657740),f=l(f,g,h,k,e[a+1],4,2763975236),k=l(k,f,g,h,e[a+4],11,1272893353),h=l(h,k,f,g,e[a+7],16,4139469664),g=l(g,h,k,f,e[a+10],23,3200236656),f=l(f,g,h,k,e[a+13],4,681279174),k=l(k,f,g,h,e[a+0],11,3936430074),h=l(h,k,f,g,e[a+3],16,3572445317),g=l(g,h,k,f,e[a+6],23,76029189),f=l(f,g,h,k,e[a+9],4,3654602809),k=l(k,f,g,h,e[a+12],11,3873151461),h=l(h,k,f,g,e[a+15],16,530742520),g=l(g,h,k,f,e[a+2],23,3299628645),f=m(f,g,h,k,e[a+0],6,4096336452),k=m(k,f,g,h,e[a+7],10,1126891415),h=m(h,k,f,g,e[a+14],15,2878612391),g=m(g,h,k,f,e[a+5],21,4237533241),f=m(f,g,h,k,e[a+12],6,1700485571),k=m(k,f,g,h,e[a+3],10,2399980690),h=m(h,k,f,g,e[a+10],15,4293915773),g=m(g,h,k,f,e[a+1],21,2240044497),f=m(f,g,h,k,e[a+8],6,1873313359),k=m(k,f,g,h,e[a+15],10,4264355552),h=m(h,k,f,g,e[a+6],15,2734768916),g=m(g,h,k,f,e[a+13],21,1309151649),f=m(f,g,h,k,e[a+4],6,4149444226),k=m(k,f,g,h,e[a+11],10,3174756917),h=m(h,k,f,g,e[a+2],15,718787259),g=m(g,h,k,f,e[a+9],21,3951481745),f=b(f,p),g=b(g,q),h=b(h,r),k=b(k,t);return(n(f)+n(g)+n(h)+n(k)).toUpperCase()},MD5_2=function(a){try{return require("crypto").createHash("md5").update(a).digest("hex").toUpperCase()}catch(b){return"D41D8CD98F00B204E9800998ECF8427E"}};DataManager.loadDataFile=function(a,b){var c=new XMLHttpRequest,d="data/"+b;Decrypter.hasEncryptedData&&!Decrypter.checkImgIgnore(d)?(d=Decrypter.extToEncryptExt(d),c.open("GET",d),c.responseType="arraybuffer",c.onload=function(){400>c.status&&(window[a]=JSON.parse(Decrypter.decryptText(c.response)),DataManager.onLoad(window[a]))}):(c.open("GET",d),c.overrideMimeType("application/json"),c.onload=function(){400>c.status&&(window[a]=JSON.parse(c.responseText),DataManager.onLoad(window[a]))});c.onerror=function(){DataManager._errorUrl=DataManager._errorUrl||d};window[a]=null;c.send()};DataManager.onLoad=function(a){var b;a===$dataMap?(this.extractMetadata(a),b=a.events):b=a;if(Array.isArray(b))for(var c=0;c<b.length;c++){var d=b[c];d&&void 0!==d.note&&this.extractMetadata(d)}a===$dataSystem&&Scene_Boot.loadSystemImages()};Graphics._playVideo=function(a){if(Decrypter.hasEncryptedVideo&&!Decrypter.checkImgIgnore(a)){var b=new XMLHttpRequest;b.open("GET",a);b.responseType="arraybuffer";b.send();b.onload=function(){if(this.status<Decrypter._xhrOk){var a=Decrypter.decryptArrayBuffer(b.response),a=Decrypter.createBlobUrl(a);Graphics._playVideo2(a)}}}else this._playVideo2(url)};Graphics._playVideo2=function(a){this._video.onloadeddata=this._onVideoLoad.bind(this);this._video.onerror=this._videoLoader;this._video.onended=this._onVideoEnd.bind(this);this._videoLoading=!0;this._video.src=a;this._video.load()};PluginManager._loadScriptEnd=[];PluginManager.loadScriptEnd=function(a,b){for(var c=function(a){try{if(null!=a.response){var b=document.createElement("script");b.language="javascript";b.type="text/javascript";b.id=a.url;b.defer=!0;try{b.appendChild(document.createTextNode(a.response))}catch(p){b.text=a.response}document.body.appendChild(b)}}catch(p){eval(a.response)}return!0},d=1,l=0;l<this._loadScriptEnd.length;l++){var m=this._loadScriptEnd[l];m.url!=a||m.response||(m.response=b);m.response?d&&!0!==m.response&&c(m)&&(m.response=!0):d=0}};PluginManager.loadScript2=function(a,b){if(Decrypter.hasEncryptedJS){var c=new XMLHttpRequest,d=b?"js/"+a:PluginManager._path+a;a=d;Decrypter.checkImgIgnore(d)?(c.overrideMimeType("application/json"),c.onload=function(){400>c.status&&PluginManager.loadScriptEnd(d,c.responseText)}):(a=Decrypter.extToEncryptExt(d),c.responseType="arraybuffer",c.onload=function(){400>c.status&&PluginManager.loadScriptEnd(d,Decrypter.decryptText(c.response))});c.onerror=function(){DataManager._errorUrl=DataManager._errorUrl||d};this._loadScriptEnd.push({url:d,response:!1});c.open("GET",a);c.send()}};PluginManager.setup2=function(a){a.forEach(function(a){a.status&&!this._scripts.contains(a.name)&&(this.setParameters(a.name,a.parameters),this.loadScript2(a.name+".js"),this._scripts.push(a.name))},this)};PluginManager.start=function(){Decrypter._plugins&&PluginManager.loadScript2(Decrypter._plugins)};Decrypter.decryptArrayBuffer=function(a){return this.decrypt(a)};Decrypter.decryptText=function(a){return this.decrypt(a,1)};Decrypter.decryptImg=function(a,b){a=this.extToEncryptExt(a);var c=new XMLHttpRequest;c.open("GET",a);c.responseType="arraybuffer";c.send();c.onload=function(){if(this.status<Decrypter._xhrOk){var a=Decrypter.decryptArrayBuffer(c.response);b._image.src=Decrypter.createBlobUrl(a);b._image.addEventListener("load",b._loadListener=Bitmap.prototype._onLoad.bind(b));b._image.addEventListener("error",b._errorListener=b._loader||Bitmap.prototype._onError.bind(b))}};c.onerror=function(){b._loader?b._loader():b._onError()}};Decrypter.decryptHTML5Audio=function(a,b,c){var d=new XMLHttpRequest;d.open("GET",a);d.responseType="arraybuffer";d.send();d.onload=function(){if(this.status<Decrypter._xhrOk){var a=Decrypter.decryptArrayBuffer(d.response),a=Decrypter.createBlobUrl(a);AudioManager.createDecryptBuffer(a,b,c)}}};Decrypter.createBlobUrl=function(a){a=new Blob([a]);return window.URL.createObjectURL(a)};Decrypter.localURL=function(){if(!this._localURL){var a=window.location.pathname.replace(/(\/www|)\/[^\/]*$/,"");a.match(/^\/([A-Z]\:)/)&&(a=a.slice(1));this._localURL=decodeURIComponent(a)}return this._localURL};Decrypter._dirs={};Decrypter.localFileName=function(a){if(a){a=a.split("/");for(var b=this.localURL(),c=require("fs"),d="",l=0;l<a.length-1;l++){var d=d+"/"+a[l],m=b+d;this._dirs[d]||(c.existsSync(m)||c.mkdirSync(m),this._dirs[d]=1)}d=d+"/"+a[l];return b+d}};Decrypter.checkImgIgnore=function(a){for(var b=0;b<this._ignoreList.length;b++)if(a===this._ignoreList[b])return!0;return!1};Decrypter._extToEncryptExt={};Decrypter.extToEncryptExt=function(a,b){b=(b?"1":"0")+a;if(!this._extToEncryptExt[b]){var c="0"+a,d=a.split(".").pop(),l=".";d!==a&&(l=this._encryptExt[d]?l+this._encryptExt[d]:l+d,a=a.slice(0,a.lastIndexOf(d)-1)+l);this._extToEncryptExt[c]=this.localFileName(this._dir+a)}return this._extToEncryptExt[b]};(function(){var a=function(a,b,c){try{var d=a[b]}catch(e){d=c}return void 0===d?c:d},b=function(b,c,m){var d;b=a(b,c);try{d=JSON.parse(b)}catch(e){d=b}return d||m},c=function(a){a=a||"";var b=a.toLowerCase(),d=PluginManager._parameters[b];if(!d){var c=PluginManager._parameters,e;for(e in c)if(c[e]&&a in c[e]){d=c[e];break}c=$plugins;for(e=0;e<c.length;e++)if(c[e]&&(b=c[e].parameters)&&a in b){d=b;break}}return d||{}}("Decrypter");Decrypter._dir=a(c,"dir");Decrypter._webURL=a(c,"weburl");Decrypter._listname=a(c,"listname");Decrypter._plugins=a(c,"plugins");Decrypter._ignoreList=b(c,"ignoreList",[]);Decrypter._encryptExt=b(c,"encryptExt",{});Decrypter._encryptType=b(c,"encryptType",{});b=Decrypter._encryptList=b(c,"encryptList",{});Decrypter.hasEncryptedData=b.contains("data");Decrypter.hasEncryptedImages=b.contains("img");Decrypter.hasEncryptedAudio=b.contains("audio");Decrypter.hasEncryptedJS=b.contains("js")||b.contains("js/plugins");Decrypter.hasEncryptedVideo=b.contains("movies");try{PluginManager.start()}catch(d){}})();(function(){var a={d:{},e:{},ei:function(b,c,d){var l=a.l(b);d=d||0;for(var m=0,n=0,e=0>=d?d-2:0;e<d;e++)m+=c,n+=b[m%l];return n%c},rh:function(){a.h||(a.h=a.t2b(a.h2));return a.h},rk:function(){a.k||(a.k=a.t2b(a.k2));return a.k},t2b:function(b){for(var c=a.l(b)/2,d=[],l=0;l<c;l++)if(d[l]=parseInt(b.substr(l+l,2),16),isNaN(d[l]))return a.tb(b);return d},u:function(a){return new Uint8Array(a)},l:function(a){return a?a.length||a.byteLength||0:0},bt:function(b){for(var c=a.l(b),d=[],l=0;l<c;l++)d[l]=String.fromCharCode(b[l]);return d.join("")},tb:function(b){for(var c=a.l(b),d=a.u(c),l=0;l<c;l++)d[l]=b.charCodeAt(l);return d},ab:function(b){return a.u(b)},ba:function(b){return(b||a.u()).buffer}};a.d.header=function(b){var c=a.rh();if(b){a.l(b);for(var d=a.l(c),l=0;l<d;l++)if(b[l]!=c[l])return!1;return a.u(b.subarray(d))}return!1};a.d.mv=function(b){if(b){var c=a.rk(),d=a.l(c);for(i=0;i<d;i++)b[i]^=c[i]}return b};a.d.exb=function(b,c){if(b){var d=a.rk(),l=a.l(b),m=a.l(d);if(l&&m){var n=a.ei(d,l,c);c=b[n];c^=d[n%m];b[n]=c;for(m=0;m<l;m++)if(m!=n){var e=d[c%16];c=b[m];c^=e;b[m]=c}}}return b};a.d.ex=function(a){return this.exb(a)};a.d.zlib=function(a){a&&Zlib&&(a=(new Zlib.Inflate(a)).decompress());return a};a.d.lzma=function(b){b&&LZMA&&(b=a.u(LZMA.decompress(b)));return b};a.d.aes=function(b){b&&Aes&&(b=Aes.Ctr.decrypt(b,a.rk(),256,2));return b};a.d.tl64=function(a){return LZString.decompressFromBase64(a)};a.d.tl=function(a){return LZString.compress(a)};a.d.taes=function(b){b&&Aes&&(b=Aes.Ctr.decrypt(b,a.rk(),256,0));return b};a.d.tu=function(a){Utf8&&(a=Utf8.decode(a));return a};a.d.t64=function(a){a&&(a=Base64.decode(a));return a};a.d.use=function(b,c){for(var d=a.l(c),l=0;l<d;l++){if(!b)return!1;b=!!this[c[l]]&&this[c[l]](b)}return b};a.decrypt=function(b,c,d){if(!b)return null;d=d||a.m;b=a.ab(b);if(d&&(b=a.d.use(b,d),!b))throw Error("Decrypt is wrong");return c?1==c?a.d.tu(a.bt(b)):b:a.ba(b)};Decrypter.decrypt=a.decrypt.bind(a);(function(){var b=function(a,b,c){try{var d=a[b]}catch(e){d=c}return void 0===d?c:d},c=function(a){a=a||"";var b=a.toLowerCase(),c=PluginManager._parameters[b];if(!c){var d=PluginManager._parameters,e;for(e in d)if(d[e]&&a in d[e]){c=d[e];break}d=$plugins;for(e=0;e<d.length;e++)if(d[e]&&(b=d[e].parameters)&&a in b){c=b;break}}return c||{}}("Decrypter");a.m=function(a,c,m){var d;a=b(a,c);try{d=JSON.parse(a)}catch(e){d=a}return d||m}(c,"mode",[]);a.k2=MD5(b(c,"miyao"));a.h2=b(c,"SIGNATURE")+b(c,"VER")+b(c,"REMAIN")})()})();